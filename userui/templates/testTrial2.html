{% extends "base.html" %}
{% load staticfiles %}

{% block nav_form %}
<ul class="nav navbar-nav" >
  <form class="navbar-form ">
<div class="btn-toolbar" role="toolbar">
<div class="btn-group col-md-offset-3 " style="position:fixed">
  <button type="button" class="btn btn-success" onClick="mapChange('2');">City Map</button>
  <button type="button" class="btn btn-success" onClick="mapChange('1');">Subway Map</button>
</div>
</div>
</form>
</ul>

                <ul class="nav navbar-nav navbar-right">
                  <form class="navbar-form navbar-left" action="/submit/{{u}}/{{trial.blockId}}/{{trial.trialNumber}}/" method="POST">
                    {% csrf_token %}
                    {% if trial.task == 1 %}
                    <a id="example" href="#" class="btn btn-success" data-toggle="popover" title="Test T-{{trial.trialNumber}}" data-placement="bottom" data-content="Please find the route with the minimum number of stations starting from {{trial.pointA}} reaching {{trial.pointB}}. <br> Kindly submit the number of stations you found and mark them on the map." role="button" data-original-title="A Title">Instructions</a>
                    {% elif trial == 2 %}
                    <a id="example" href="#" class="btn btn-success" data-toggle="popover" title="Test T-{{trial.trialNumber}}" data-placement="bottom" data-content="Please pinpoint the nearest station to {{trial.pointA}}. <br> kindly, submit its name in the text field." role="button" data-original-title="A Title">Instructions</a>
                    {% endif %}
                    <div class="form-group">
                      <input type="text" id="answer_inp" class="form-control" style="width: 300px;text-align: center;" value="" name="answer" placeholder="Answer">
                    </div>
                    <input type="text" name="d2" id= "timer" value="0" class="form-control" style="display:none" >
                    <button type="submit" class="btn btn-success">Confirm</button>
                      <div class="dropdown btn-group">
                        <button href="#" class="btn btn-success dropdown-toggle" type="button" data-toggle="dropdown">Selected Items<span id="count_selected"></span>
                          <span style="border-top-color: #FFFFFF;border-bottom-color: #FFFFFF;" class="caret"></span>
                        </button>
                        <ul role="presentation" class="dropdown-menu" id="div_selected">
                        <li class="divider"></li>
                        </ul>
                      </div>


                  </form>
                </ul>

{% endblock %}

{% block content%}
  <!-- <div>
    <div> </div>
    <div style="float:left; width:500px; backgroud: RED"> </div>
    <div> </div>  
  </div> -->




  <div class="row" >


<center>
        <div class="map_area">


            <div>
              <div id="1"  style="display:none;" class="maps col-md-offset-3 ">
              <img id="zoom_01" src='{% static "img/manMetroMap.png" %}' data-zoom-image='{% static "img/manMetroMap.png" %}'  width="800"   border="0" usemap="#map">
              </div>
              <div id="2" class="maps col-md-offset-3 ">
              <img id="zoom_02" src='{% static "img/smusedStreetMapFinal.jpg" %}' data-zoom-image='{% static "img/usedStreetMapFinal.jpg" %}' usemap="#map2" width="1000">
              </div>

            </div>
        </div>
</center>
        {% include "metropoints.html" %}
        {% include "citypoints.html" %}
            

    <br>
    <div class="">

    </div>
  </div>
  <div style="
position: fixed;
left: 0;
bottom: 0;
height: 200px;
width: 400px;

opacity: 0.4;" id="demo-container">
<div style="opacity:1;color: black;">
</div>
</div>
  <div style="
position: fixed;
left: 0;
bottom: 0;
height: 200px;
width: 400px;

opacity: 0.4;" id="demo-container2">
<div style="opacity:1;color: black;">
</div>
</div>




<a href="#" class="scrollup btn btn-success"><span class="glyphicon glyphicon-chevron-up"></span>Top</a>
<style type="text/css">

  .scrollup{
   
    position:fixed;
    bottom:30px;
    left:600px;
    display:none;
    color: white;
}
  .zoomContainer{
    z-index: -1;
    }
</style>
{% endblock %}

  {% block js %}
  <script src="{% static "js/jquery.elevatezoom.js" %}"></script>
  <script src="{% static "js/jquery.maphilight.min.js" %}"></script>

    <script type="text/javascript">



     $( document ).ready(function() {

      $('#zoom_01').maphilight({"strokeColor":"0000ff" ,"strokeWidth":3,"fillColor":"ff0000","fillOpacity":0.3});
      $('#zoom_02').maphilight({"strokeColor":"0000ff" ,"strokeWidth":1,"fillColor":"ff0000","fillOpacity":0.3});

         starttimer();
     });

    function mapChange(id)
    {
        $(".maps").fadeOut("slow",function(){$("#"+id).fadeIn("slow");});
        
            $("#zoom_0"+id).elevateZoom({
                      zoomWindowPosition: "demo-container", 
                      zoomWindowWidth:400,
                      zoomWindowHeight:200,
                      scrollZoom : true,
                      
            });
    }

    $("#zoom_02").elevateZoom({
          zoomWindowPosition: "demo-container", 
          zoomWindowWidth:400,
          zoomWindowHeight:200,
          scrollZoom : true,
          
    }); 
    </script>
        <script>
    $(function() {


      var area_tmp =  $('#map2_div area');
      var classes = "";
      var class_to_show = "";

            area_tmp.click(function(e) {
            e.preventDefault();
            area_tmp.mouseout();
            var data = $(this).mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $(this).data('maphilight', data).trigger('alwaysOn.maphilight');
            $(this).toggleClass("clicked");
            console.log($(this).attr('class'));
            console.log($(this));
           classes = $(this).attr('class');
           class_to_show = classes.split(" ");
           $("."+class_to_show).mouseover();
           checkclicked();

        });

    });

  function changeval(changed){
    $("#answer_inp").val(changed);

  }

function checkclicked(){
  var div_selected_tmp = $("#div_selected");
 div_selected_tmp.html("");

  var $html =""
  var $clicked_items=$( ".clicked" );
  $clicked_items.each(function() {
  $("#count_selected").html("("+$clicked_items.length+")")
  var $tmp_alt = $(this).attr("alt");
  $html = $html+'<li role="presentation"><a role="menuitem" class="selected_itms" value=0 tabindex="1"  onClick="changeval(\'' + $tmp_alt + '\')" href="#" >'+ $tmp_alt +'</a></li>';

// $("#answer_inp").val('+$tmp_alt +');
  
});

  div_selected_tmp.html($html);
}
    </script>
  {% endblock %}

